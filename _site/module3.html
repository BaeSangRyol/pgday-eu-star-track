<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="shortcut icon" href="../../assets/ico/favicon.ico">

    <title>PhoneGap Day EU Workshop</title>

    <!-- Bootstrap core CSS -->
    <link href="bootstrap/css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="css/styles.css" rel="stylesheet">



    <!-- Just for debugging purposes. Don't actually copy this line! -->
    <!--[if lt IE 9]><script src="../../assets/js/ie8-responsive-file-warning.js"></script><![endif]-->

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-72845162-1', 'auto');
        ga('send', 'pageview');

    </script>
</head>

<body>
<div class="navbar navbar-default navbar-static-top" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="index.html">PhoneGap Day EU Essentials Workshop 2016</a>
        </div>
        <div class="navbar-collapse collapse">
            <ul class="nav navbar-nav navbar-right">
                <li><a
                        href="https://github.com/hollyschinsky/spotify-browser"><img
                        src="images/icon-github.png" style="border: none;margin: -4px 0;height: 28px;width: 28px;"/>
                    GitHub
                    Project</a></li>
            </ul>
        </div><!--/.nav-collapse -->
    </div>
</div>


<div class="container">

<div class="row">

    <div class="col-xs-12 col-sm-8">
        <h1>Module 3&#58; Spotify API Call and Results Handling</h1>
        <!--<hr/>-->
        <h3 id="overview">Overview</h3>
<p>This is a 2-part module where you will implement the submit button handling from our main view to call the Spotify API in Part 1 and then
 create your list template to load the data into in Part 2.</p>

<h3 id="part-1">Part 1</h3>
<ol>
  <li>
    <p>Open <code class="highlighter-rouge">my-app.js</code> and add the following code block to handle the submit button using page level events:</p>

    <div class="highlighter-rouge"><pre class="highlight"><code> $$(document).on('click', '#btnSearch', function (e) {
     var term = $$("#term").val();
     if (term.length==0) {
         myApp.alert("Please enter a search term.");
     }
     else {
         var mediaType = "track";
         var numResults = $$("#numResults").val()
    
         var url = "https://api.spotify.com/v1/search?q=" + term +"&amp;type=" + mediaType + "&amp;limit=" + numResults;                
    
         $$.ajax({
             dataType: 'json',
             url: url,
             success: function (resp) {
                 myApp.alert("Number of results " + resp.tracks.items.length);
             },
             error: function (xhr) {
                 console.log("Error on ajax call " + xhr);
             }
         });
     }
 })
</code></pre>
    </div>
  </li>
  <li>
    <p>Open the app in the browser and make sure you see an alert with a number of results returned. Use the Chrome Developer tools to
 help you inspect and debug as needed.</p>
  </li>
</ol>

<p><img class="screenshot-lg" src="images/numResults.png" /></p>

<h3 id="part-2">Part 2</h3>
<ol>
  <li>
    <p>Add the following template definition to represent our list view in <code class="highlighter-rouge">index.html</code> just before the <code class="highlighter-rouge">&lt;script&gt;</code> include for cordova.js:</p>

    <div class="highlighter-rouge"><pre class="highlight"><code> &lt;script id="listTemplate" type="text/template7"&gt;
     &lt;div class="navbar"&gt;
         &lt;div class="navbar-inner"&gt;
             &lt;div class="left"&gt;&lt;a href="#" class="back link"&gt; &lt;i class="icon icon-back"&gt;&lt;/i&gt;&lt;span&gt;Back&lt;/span&gt;&lt;/a&gt;&lt;/div&gt;
             &lt;div class="center sliding"&gt;Results&lt;/div&gt;
             &lt;div class="right"&gt;
                 &lt;a href="#" class="link icon-only open-panel"&gt; &lt;i class="icon icon-bars"&gt;&lt;/i&gt;&lt;/a&gt;
             &lt;/div&gt;
         &lt;/div&gt;
     &lt;/div&gt;
        
     &lt;div class="page" data-page="list"&gt;
         &lt;form class="searchbar searchbar-init" data-search-list=".list-block-search" data-search-in=".item-title"
               data-searchbar-found=".searchbar-found" data-searchbar-not-found=".searchbar-not-found"&gt;
             &lt;div class="searchbar-input"&gt;
                 &lt;input type="search" placeholder="Search"&gt;
                 &lt;a href="#" class="searchbar-clear"&gt;&lt;/a&gt;
             &lt;/div&gt;
             &lt;a href="#" class="searchbar-cancel"&gt;Cancel&lt;/a&gt;
         &lt;/form&gt;
         &lt;div class="searchbar-overlay"&gt;&lt;/div&gt;
         &lt;div class="page-content"&gt;
             &lt;!-- no result --&gt;
             &lt;div class="content-block searchbar-not-found"&gt;
                 Nothing found
             &lt;/div&gt;
    
             &lt;div id="mediaList" class="list-block media-list list-block-search searchbar-found"&gt;
                 &lt;ul&gt;
                     {{#each this}}
                     &lt;li class="swipeout"&gt;
                         &lt;div class="swipeout-content"&gt;
                             &lt;a href='#' class="item-content item-link"&gt;                                    
                                 &lt;div class="item-media"&gt;
                                     &lt;img data-src="{{album.images[2].url}}" class="lazy"&gt;
                                 &lt;/div&gt;
                                 &lt;div class="item-inner"&gt;
                                     &lt;div class="item-title-row"&gt;
                                         &lt;div class="item-title"&gt;{{name}}&lt;/div&gt;
                                     &lt;/div&gt;
                                     &lt;div class="item-subtitle"&gt;{{artists[0].name}}&lt;/div&gt;
                                     &lt;div class="item-text"&gt;{{album.name}}&lt;/div&gt;
                                 &lt;/div&gt;
                             &lt;/a&gt;
                         &lt;/div&gt;
                         &lt;div class="swipeout-actions-right"&gt;
                             &lt;a href="#" class="bg-orange favorite" data-item="{{@index}}"&gt;&lt;i class="icon fa fa-star fa-2x"&gt;&lt;/i&gt;&lt;/a&gt;
                             &lt;a href="#" class="bg-blue share" data-item="{{@index}}"&gt;&lt;i class="icon fa fa-share fa-2x"&gt;&lt;/i&gt;&lt;/a&gt;
                         &lt;/div&gt;
                         &lt;div class="swipeout-actions-left"&gt;
                             &lt;a href="#" class="bg-green preview" data-item="{{@index}}"&gt;&lt;i class="icon fa fa-play fa-2x"&gt;&lt;/i&gt;&lt;/a&gt;
                         &lt;/div&gt;
                     &lt;/li&gt;
                     {{/each}}
                 &lt;/ul&gt;
             &lt;/div&gt;
         &lt;/div&gt;
     &lt;/div&gt;
    &lt;/script&gt;
</code></pre>
    </div>

    <blockquote>
      <p>Templates are loaded into the DOM when the app initializes and bound to with data at request time. The differences between the different ways
 you can load pages using Framework7 is worth reviewing <a href="http://www.idangero.us/framework7/docs/pages-ajax.html#.Vqbv91MrKjQ">here</a>.</p>
    </blockquote>
  </li>
  <li>
    <p>Open <code class="highlighter-rouge">my-app.js</code> again and modify the Submit button handler’s <code class="highlighter-rouge">success</code> function to remove the alert and instead use the built-in F7 router to 
load the new list template. We’ll also set the context for it to the results of our Spotify call. The expressions in the template will be bound to
that data context.</p>

    <div class="highlighter-rouge"><pre class="highlight"><code> $$.ajax({
     dataType: 'json',
     url: url,
     success: function (resp) {
          mainView.router.load({
              template: Template7.templates.listTemplate,
              context: resp.tracks.items
         });
     },
     error: function (xhr) {
         console.log("Error on ajax call " + xhr);
     }
 });
</code></pre>
    </div>
  </li>
  <li>
    <p>Now try running your app again and check to make sure you see the new list page returned with the results after you submit. Your list page 
should look something like the following:</p>

    <p><img class="screenshot-md" src="images/list2.PNG" /></p>
  </li>
  <li>
    <p>Go ahead and delete the <code class="highlighter-rouge">about.html</code> page in your root <code class="highlighter-rouge">www</code> folder to avoid future confusion. It was part of the original F7 template 
project we created but will not be used in the final app.</p>
  </li>
</ol>

<div class="row" style="margin-top:40px;">
<div class="col-sm-12">
<a href="module2.html" class="btn btn-default"><i class="glyphicon glyphicon-chevron-left"></i> Previous</a>
<a href="module4.html" class="btn btn-default pull-right">Next <i class="glyphicon
glyphicon-chevron-right"></i></a>
</div>
</div>



        <!--<div class="row" style="margin-top: 30px;">-->
            <!--<div class="col-xs-12">-->
                <!--<div id="disqus_thread"></div>-->
                <!--<script type="text/javascript">-->
                    <!--/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */-->
                    <!--var disqus_shortname = 'salesforcedeveloperworkshop'; // required: replace example with your forum shortname-->

                    <!--/* * * DON'T EDIT BELOW THIS LINE * * */-->
                    <!--(function() {-->
                        <!--var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;-->
                        <!--dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';-->
                        <!--(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);-->
                    <!--})();-->
                <!--</script>-->
                <!--<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>-->
                <!--<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>-->
            <!--</div>-->
        <!--</div>-->


    </div>

    <div class="col-xs-12 col-sm-4 right-nav">

        <div class="panel panel-default">
            <!-- Default panel contents -->
            <div class="panel-heading" style="font-variant:small-caps;font-size: 18px;">Modules</div>
            <ol class="list-group">
                <li><a href="lesson1.html">Project Setup/PhoneGap Tooling</a></li>
                <li><a href="lesson2.html">App Structure Review</a></li>
                <li><a href="lesson3.html">Local Storage/Offline Handling</a></li>
                <li><a href="lesson4.html">Add Searchbar</a></li>
                <li><a href="lesson5.html">Making Your App Feel Native</a></li>
                <li><a href="lesson8.html">Add Swipeouts</a></li>
                <li><a href="lesson7.html">Add Native Share Feature</a></li>
                <li><a href="lesson6.html">Configuring Your App</a></li>
                <li><a href="lesson10.html">Next Steps</a></li>
            </ol>
            <p></p>
        </div>

<a href="https://twitter.com/share" class="twitter-share-button" data-size="large"
   data-url="http://hollyschinsky.github.io/phonegap-workshop"
   data-text="PhoneGap Tutorial #Cordova #PhoneGap">Tweet</a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>

<a href="https://twitter.com/devgirlfl" class="twitter-follow-button" data-show-count="true"
   data-size="large" data-lang="en">Follow
    @devgirlfl</a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>

    </div>

</div>

</div>

<div class="container">
    <div id="footer">
        <a href="http://devgirl.org"><p class="text-muted">Holly Schinsky</p></a>
    </div>
</div>


<script src="lib/jquery.js"></script>
<script src="bootstrap/js/bootstrap.min.js"></script>
</body>
</html>
