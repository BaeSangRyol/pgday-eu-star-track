<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="shortcut icon" href="../../assets/ico/favicon.ico">

    <title>PhoneGap Day EU Workshop</title>

    <!-- Bootstrap core CSS -->
    <link href="bootstrap/css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="css/styles.css" rel="stylesheet">



    <!-- Just for debugging purposes. Don't actually copy this line! -->
    <!--[if lt IE 9]><script src="../../assets/js/ie8-responsive-file-warning.js"></script><![endif]-->

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-72845162-1', 'auto');
        ga('send', 'pageview');

    </script>
</head>

<body>
<div class="navbar navbar-default navbar-static-top" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="index.html">PhoneGap Day EU Essentials Workshop 2016</a>
        </div>
        <div class="navbar-collapse collapse">
            <ul class="nav navbar-nav navbar-right">
                <li><a
                        href="https://github.com/hollyschinsky/spotify-browser"><img
                        src="images/icon-github.png" style="border: none;margin: -4px 0;height: 28px;width: 28px;"/>
                    GitHub
                    Project</a></li>
            </ul>
        </div><!--/.nav-collapse -->
    </div>
</div>


<div class="container">

<div class="row">

    <div class="col-xs-12 col-sm-8">
        <h1>Module 2&#58; App Walkthrough</h1>
        <!--<hr/>-->
        <p>In this lesson we’ll walk through the base Star Track app to learn how it works and look at some important pieces to be aware
of including a bit about some Framework7 components and settings specifically. Through this exercise we’ll also gain an
understanding of how a <a href="guides/single-page-architecture.html">Single Page Application</a> works.</p>

<blockquote>
  <p><strong>A Single Page App</strong> is an app that loads a single HTML page and dynamically updates that page as the user interacts with the app. 
SPAs use AJAX and HTML5 to create fluid and responsive Web apps without constant page reloads.
<br /><a href="https://msdn.microsoft.com/en-us/magazine/dn463786.aspx">Source</a><br /></p>
</blockquote>

<h2 id="framework7-initialization">Framework7 initialization</h2>
<p>When you initialize your app in Framework7, there are various parameters you could specify depending on how you
want things to work in your app. Review the <a href="http://framework7.io/docs/init-app.html">docs here</a> for all of the options available. 
In the Star Track app, the following are used and set in the <code class="highlighter-rouge">www/js/my-app.js</code> file:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>var myApp = new Framework7({
  material: isIos? false : true,       // activate material-specific
  template7Pages: true,                // enable Template7 rendering
  precompileTemplates: true,           // auto compile all templates
  swipePanel: 'left',                  // enable swipe for side panels
  swipePanelActiveArea: '30',          // Width to trigger swipe panel
  swipeBackPage: true,                 // Swipe back from left edge 
  animateNavBackIcon: true,            // Dynamic navbar icon animation
  pushState: !!Framework7.prototype.device.os,  //enable hash navigation in browser mode
});
</code></pre>
</div>

<h2 id="themes">Themes</h2>
<p>Open the <code class="highlighter-rouge">www/index.html</code> and locate the <code class="highlighter-rouge">&lt;body&gt;</code> tag. You can give your app a new theme by modifying the <code class="highlighter-rouge">theme-green</code> class to another color. To find out which colors are supported, refer to the <a href="http://framework7.io/docs/color-themes.html">Framework7 theme docs</a> for the platform you’re testing on. If you’re running it in the browser it will default to material using code set in the <code class="highlighter-rouge">www/js/init-styles.js</code>
file. For instance, you could choose purple if you’re running with the material style:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>&lt;body class="theme-purple"&gt;
</code></pre>
</div>

<p>Alternatively, two layout themes (white and dark) are also supported and affect the background and font colors. The default is white. Go ahead and apply the <code class="highlighter-rouge">layout-dark</code> class to the <code class="highlighter-rouge">&lt;body&gt;</code> tag now to see how it affects the app:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>&lt;body class="layout-dark"&gt;
</code></pre>
</div>

<p>For this workshop, let’s set it to a combination of the following:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>&lt;body class="layout-dark theme-green"&gt;
</code></pre>
</div>

<p>There’s one more change to make before moving on here due to the change for the dark theme. We need to modify the search
input field to change the <code class="highlighter-rouge">type="search"</code> to <code class="highlighter-rouge">type="text"</code> to ensure the text content is displayed in white with this new
color scheme. Locate the following <code class="highlighter-rouge">&lt;input&gt;</code> element and change the type to <code class="highlighter-rouge">text</code> as shown:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>&lt;div class="item-input"&gt;
    &lt;input name="q" type="text" placeholder="track, artist or album"
    autocorrect="off" autocapitalize="off"&gt;
&lt;/div&gt;
</code></pre>
</div>

<blockquote>
  <p>The color themes will be applied a bit differently between platforms. You could also apply specific themes to sub-elements within the body as well, like page, view, navbar, list-block etc. Refer to <a href="http://framework7.io/docs/color-themes.html">the docs</a> for more details on other classes that can be used to change the background color, font color and border color in their utility classes 
as well.</p>
</blockquote>

<h2 id="ui-structure">UI Structure</h2>

<p>Single page applications are considered the best approach for hybrid app development. In a single page application, state changes occur via JavaScript using templates and DOM manipulation rather than making calls to a server to return an HTML page. The logic stays on the client side and routing and templates are used to manipulate views when actions occur. Numerous popular frameworks support this concept (Angular, Ember etc) and have it built-in to the framework. In those cases you will define your routes and templates as the framework prescribes.</p>

<ul>
  <li>
    <p><strong>Views</strong> - The wrapper container for all visual views. Only one <code class="highlighter-rouge">views</code> element is allowed</p>
  </li>
  <li>
    <p><strong>View</strong> - A separate visual part of app with its own settings, navigation and history. You must have a default view with class <code class="highlighter-rouge">view-main</code> since it’s the default where all pages are loaded into.</p>
  </li>
  <li>
    <p><strong>Pages</strong> - A wrapper container for pages within a single view.</p>
  </li>
  <li>
    <p><strong>Page</strong> - Similar to a web page, this is what we’re transitioning between. There can be many pages within a single view.</p>
  </li>
  <li>
    <p><strong>Side Panel</strong> - You can use up to 2 panels in an app, one on left side and another one on right side and they should be added to the beginning of the body tag. These panels are hidden initially and can be used
for a side menu. You can also specify an effect when the panel is shown by setting a class to either <code class="highlighter-rouge">panel-cover</code> or <code class="highlighter-rouge">panel-reveal</code>. Modify yours now, then try clicking the hamburger icon to 
trigger the panel to open to see the difference.</p>

    <div class="highlighter-rouge"><pre class="highlight"><code>&lt;div class="panel panel-left panel-reveal"&gt;
</code></pre>
    </div>
  </li>
</ul>

<p><br /></p>

<h4 id="views-and-pages">Views and Pages</h4>
<p>Based on the above terminology, in our Star Track App we are using one <strong>view</strong> (stack of pages called main view) and we navigate between these pages by 
loading different <strong>templates</strong> into the main view container along with the required <strong>data</strong> to bind to that page so the expressions are properly evaluated. This is based 
on the <a href="guides/single-page-architecture.html"><strong>Single Page Architecture</strong></a> approach and helps ensure your hybrid apps are performant.</p>

<p>The high level DOM hierarchy to describe the app looks like this.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>&lt;div class="views"&gt;
  &lt;div class="view view-main"&gt;
    &lt;div class="navbar"&gt;
    &lt;div class="pages"&gt;
      &lt;div data-page="index" class="page"/&gt;
      &lt;div data-page="results" class="page"/&gt;
      &lt;div data-page="favorites" class="page"/&gt;
      &lt;div data-page="details" class="page"/&gt;
  &lt;/div&gt;
&lt;/div&gt;
</code></pre>
</div>

<p><img class="screenshot-md" src="images/arch.png" /></p>

<p><br /></p>

<p><img class="screenshot-full" src="images/view-pages.png" /></p>

<h4 id="main-view">Main View</h4>
<p>The main view displays the static <code class="highlighter-rouge">index</code> page initially and then transitions the results page in by loading the template with the results of the ajax call to the Spotify API. Open your <code class="highlighter-rouge">index.html</code> file now and locate the <code class="highlighter-rouge">index</code> page denoted by the
<code class="highlighter-rouge">data-page</code> attribute set to index:</p>

<div class="highlighter-rouge"><pre class="highlight"><code> &lt;div data-page="index" class="page"&gt;
</code></pre>
</div>

<p>Then open the <code class="highlighter-rouge">www/js/my-app.js</code> file and notice the code used to add this main view along with some parameters to
enable a dynamic navbar and turn on cacheing so previous pages are held in the DOM.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>  var mainView = myApp.addView('.view-main', {
    dynamicNavbar: true,  // enable Dynamic Navbar for iOS
    domCache: true,       // previous pages stay in DOM
  });
</code></pre>
</div>

<p><br /></p>

<h4 id="templates">Templates</h4>
<p>The other <em>pages</em> for the app are defined in <a href="http://framework7.io/docs/template7.html">Template7 templates</a> since they are used dynamically with data binding. You can find the definitions for them in the script tags under <code class="highlighter-rouge">index.html</code>.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>  &lt;script type="text/template7" id="results"&gt;
      -
    &lt;div class="page" data-page="results"&gt;
      -
  &lt;/script&gt;  
  &lt;script type="text/template7" id="details"&gt;
      -
      &lt;div class="page" data-page="details"&gt;
      -            
  &lt;/script&gt;    
  &lt;script type="text/template7" id="favorites"&gt;
      -
      &lt;div class="page" data-page="favorites"&gt;
      -
  &lt;/script&gt;    
</code></pre>
</div>

<p>Open the app in the browser and view it with the Chrome devtools to notice how the pages are loaded from the templates and 
removed depending on what action you take.</p>

<p><br /></p>

<h4 id="routing">Routing</h4>
<p>The <a href="http://framework7.io/docs/router-api.html">Framework7 Router</a> is used to navigate between the pages. For instance, when the results are returned from the ajax call to Spotify, the following code loads the <code class="highlighter-rouge">results</code> page by specifying the template id and passing the response data in as the context and named <code class="highlighter-rouge">tracks</code>. Open the <code class="highlighter-rouge">www/js/my-app.js</code> file and locate the <code class="highlighter-rouge">$$.ajax</code> call to see how it all works.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>mainView.router.load({
  template: myApp.templates.results,
  context: {
    tracks: resp.tracks,
  },
});
</code></pre>
</div>

<p>The data is then accessed in the template via the <code class="highlighter-rouge">tracks</code> variable. You can open the <code class="highlighter-rouge">index.html</code> file and locate the <code class="highlighter-rouge">results</code>
template to take a look. The double curly braces are used for expressions and variables. Check out the <a href="http://www.idangero.us/template7/">Template7 website</a> for more details about syntax, built-in expressions and helpers.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>&lt;ul&gt;
   {{#each tracks.items}}
   &lt;li&gt;
    &lt;a href="#" class="item-link item-content"
     data-item="{{@index}}"
     data-context="{{stringify this}}"
     data-template="details"&gt;
     &lt;div class="item-media"&gt;
       &lt;img width="80" src="{{this.album.images[0].url}}"&gt;
     &lt;/div&gt;
     &lt;div class="item-inner"&gt;
        &lt;div class="item-title-row"&gt;
          &lt;div class="item-title"&gt;{{this.name}}&lt;/div&gt;
          &lt;div class="item-after"&gt;{{durationFromMs this.duration_ms}}&lt;/div&gt;
        &lt;/div&gt;
        &lt;div class="item-subtitle"&gt;{{this.artists[0].name}}&lt;/div&gt;
        &lt;div class="item-text"&gt;{{this.album.name}}&lt;/div&gt;
      &lt;/div&gt;
    &lt;/a&gt;
    &lt;/li&gt;
    {{/each}}
 &lt;/ul&gt;
</code></pre>
</div>

<h2 id="cordova---device-ready-event">Cordova - Device Ready Event</h2>
<p>The <code class="highlighter-rouge">deviceready</code> event is a Cordova event indicating the Cordova bridge is completely set up. You should ensure you
check for this event before using any plugins.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>$$(document).on('deviceready', function deviceIsReady() {
  console.log('Device is ready!');
});
</code></pre>
</div>

<div class="row" style="margin-top:40px;">
<div class="col-sm-12">
<a href="lesson1.html" class="btn btn-default"><i class="glyphicon glyphicon-chevron-left"></i> Previous</a>
<a href="lesson3.html" class="btn btn-default pull-right">Next <i class="glyphicon
glyphicon-chevron-right"></i></a>
</div>
</div>



        <!--<div class="row" style="margin-top: 30px;">-->
            <!--<div class="col-xs-12">-->
                <!--<div id="disqus_thread"></div>-->
                <!--<script type="text/javascript">-->
                    <!--/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */-->
                    <!--var disqus_shortname = 'salesforcedeveloperworkshop'; // required: replace example with your forum shortname-->

                    <!--/* * * DON'T EDIT BELOW THIS LINE * * */-->
                    <!--(function() {-->
                        <!--var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;-->
                        <!--dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';-->
                        <!--(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);-->
                    <!--})();-->
                <!--</script>-->
                <!--<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>-->
                <!--<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>-->
            <!--</div>-->
        <!--</div>-->


    </div>

    <div class="col-xs-12 col-sm-4 right-nav">

        <div class="panel panel-default">
            <!-- Default panel contents -->
            <div class="panel-heading" style="font-variant:small-caps;font-size: 18px;">Modules</div>
            <ol class="list-group">
                <li><a href="lesson1.html">Project Setup/PhoneGap Tooling</a></li>
                <li><a href="lesson2.html">App Walkthru</a></li>
                <li><a href="lesson3.html">Detecting Offline</a></li>
                <li><a href="lesson4.html">Searchbar Filter</a></li>
                <li><a href="lesson5.html">Add Swipeout Action</a></li>
                <li><a href="lesson6.html">Add Native Share Feature</a></li>
                <li><a href="lesson7.html">Making Your App Feel Native</a></li>
                <li><a href="lesson8.html">Configuring Your App</a></li>
                <li><a href="lesson9.html">Next Steps</a></li>
                <li><a href="lesson10.html">Optional: Remote Debugging</a></li>
            </ol>
            <p></p>
        </div>

<a href="https://twitter.com/share" class="twitter-share-button" data-size="large"
   data-url="http://hollyschinsky.github.io/phonegap-workshop"
   data-text="PhoneGap Tutorial #Cordova #PhoneGap">Tweet</a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>

<a href="https://twitter.com/devgirlfl" class="twitter-follow-button" data-show-count="true"
   data-size="large" data-lang="en">Follow
    @devgirlfl</a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>

    </div>

</div>

</div>

<div class="container">
    <div id="footer">
        <a href="http://devgirl.org"><p class="text-muted">Holly Schinsky</p></a>
    </div>
</div>


<script src="lib/jquery.js"></script>
<script src="bootstrap/js/bootstrap.min.js"></script>
</body>
</html>
